/*!

=========================================================
* Black Dashboard React - v1.1.0
=========================================================

* Product Page: https://www.creative-tim.com/product/black-dashboard-react
* Copyright 2020 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://github.com/creativetimofficial/black-dashboard-react/blob/master/LICENSE.md)

* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

*/
/*! For license information please see main.a23139ca.chunk.js.LICENSE.txt */
(this["webpackJsonpblack-dashboard-react"]=this["webpackJsonpblack-dashboard-react"]||[]).push([[0],{104:function(e,t,a){e.exports=a.p+"static/media/dropzone.4dd7388d.png"},109:function(e,t,a){e.exports=a.p+"static/media/plane.4aeb612b.png"},110:function(e,t,a){e.exports=a.p+"static/media/plane-unselected.724db06b.png"},113:function(e,t,a){},114:function(e,t,a){},115:function(e,t,a){},116:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),o=a(16),c=a.n(o),r=a(18),s=a(123),i=a(33),m=a(26),d=a(20),h=a(71),g=a.n(h),p=a(70),u=a(61),f=a(62),E=a(23),y=a(66),v=a(67),F=a(65);var b=({isOpen:e,setIsOpen:t})=>{const a=()=>t(!e);return l.a.createElement(p.a,{isOpen:e,toggle:a},l.a.createElement(u.a,{toggle:a},"Settings"),l.a.createElement(f.a,null,l.a.createElement(y.a,null,l.a.createElement(v.a,{addonType:"prepend"},l.a.createElement(E.a,{style:{marginTop:0,width:"7em"}},"IP")),l.a.createElement(F.a,{style:{height:"3.3em",color:"black"},defaultValue:localStorage.getItem("FlightControl_server_ip"),onBlur:e=>{localStorage.setItem("FlightControl_server_ip",e.target.value)}})),l.a.createElement(y.a,null,l.a.createElement(v.a,{addonType:"prepend"},l.a.createElement(E.a,{style:{marginTop:0,width:"7em"}},"PORT")),l.a.createElement(F.a,{style:{height:"3.3em",color:"black"},defaultValue:localStorage.getItem("FlightControl_server_port"),onBlur:e=>{localStorage.setItem("FlightControl_server_port",e.target.value)}}))))},S=a(68),_=a(64),O=a(76);const k=()=>{const e=localStorage.getItem("FlightControl_server_ip")||"localhost",t=localStorage.getItem("FlightControl_server_port")||"44336";return"https://".concat(e,":").concat(t)},C=e=>{const t=e.getUTCFullYear().toString(),a=(e.getUTCMonth()+1).toString().padStart(2,"0"),n=e.getUTCDate().toString().padStart(2,"0"),l=e.getUTCHours().toString().padStart(2,"0"),o=e.getUTCMinutes().toString().padStart(2,"0"),c=e.getUTCSeconds().toString().padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(n,"T").concat(l,":").concat(o,":").concat(c,"z")};var I=({internalFlights:e,externalFlights:t,selectedFlightId:o,setSelectedFlightPlan:c,setInternalFlights:r,notify:s})=>{const i=Object(n.useCallback)(e=>{var t,a=Object(d.a)(e);try{for(a.s();!(t=a.n()).done;){let e=t.value;console.log("Received file"),console.log(e);if("json"!==e.name.split(".").pop().toLowerCase()){s("danger","Only JSON Files Are Allowed");continue}const a=new FileReader;a.onabort=()=>console.log("file reading was aborted"),a.onerror=()=>console.log("file reading has failed"),a.onload=()=>{const e=a.result;fetch("".concat(k(),"/api/FlightPlan/"),{method:"POST",headers:{"Content-Type":"application/json"},body:e}).then(e=>{console.log("Success: Added FlightPlan successfully"),s("success","Added Flight Plan Successfully")}).catch(e=>{console.error("Error:",e),s("danger",e.message)})},a.readAsText(e)}}catch(n){a.e(n)}finally{a.f()}},[]),h=Object(O.a)({onDrop:i,noClick:!0}),g=h.getRootProps,p=h.getInputProps,u=h.isDragActive,f=[];for(var y=0,v=Object.keys(e);y<v.length;y++){let t=v[y];const a=e[t].company_name;f.push(l.a.createElement(S.a,{active:o===t,onClick:e=>{"BUTTON"===e.target.tagName?e.preventDefault():fetch("".concat(k(),"/api/FlightPlan/").concat(t)).then(e=>e.json()).then(e=>{c(e,t)}).catch(e=>{console.error("Error:",e),s("danger",e.message)})},key:t,tag:"a",href:"#",action:!0},"Flight ".concat(t,"# - ").concat(a),l.a.createElement(E.a,{color:"danger",size:"sm",style:{float:"right"},onClick:()=>{fetch("".concat(k(),"/api/Flights/").concat(t),{method:"DELETE"}).then(a=>{console.log("Success: Deleted Flight ".concat(t," Successfully"),a),s("success","Deleted Flight ".concat(t," Successfully"));let n=Object(m.a)({},e);delete n[t],r(n)}).catch(e=>{console.error("Error:",e),s("danger",e.message)})}},"X")))}const F=[];for(var b=0,C=Object.keys(t);b<C.length;b++){let e=C[b];const a=t[e].company_name;F.push(l.a.createElement(S.a,{onClick:t=>{fetch("".concat(k(),"/api/FlightPlan/").concat(e)).then(e=>e.json()).then(t=>{c(t,e)}).catch(e=>{console.error("Error:",e),s("danger",e.message)})},key:e,tag:"a",href:"#",action:!0},"Flight ".concat(e,"# - ").concat(a)))}const I={textTransform:"uppercase",textAlign:"center",margin:"0"};return l.a.createElement("div",g(),l.a.createElement("input",p()),u?l.a.createElement("div",{style:{borderStyle:"dashed",borderWidth:"thick",height:"91.5vh",backgroundImage:"url(".concat(a(104),")"),backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain"}}):l.a.createElement("div",null,l.a.createElement("h3",{style:I},"Internals"),l.a.createElement(_.a,{style:{height:"40vh",overflow:"auto"}},f),l.a.createElement("p",null),l.a.createElement("h3",{style:I},"Externals"),l.a.createElement(_.a,{style:{height:"40vh",overflow:"auto"}},F)))},T=a(63);var P=({selectedFlightPlan:e})=>{const t={paddingTop:"0.5em",paddingBottom:"0.5em"},a={paddingTop:"0.8em",paddingBottom:"0.8em"},n=e.initial_location.latitude,o=e.initial_location.longitude,c="[".concat(n,", ").concat(o,"]"),r=e.segments.slice().pop(),s=r.latitude,i=r.longitude,m="[".concat(s,", ").concat(i,"]"),h=(e=>{const t=parseInt(e.slice(0,4)),a=parseInt(e.slice(5,7))-1,n=parseInt(e.slice(8,10)),l=parseInt(e.slice(11,13)),o=parseInt(e.slice(14,16)),c=parseInt(e.slice(17,19));return new Date(Date.UTC(t,a,n,l,o,c))})(e.initial_location.date_time);let g=new Date(h.getTime());var p,u=Object(d.a)(e.segments);try{for(u.s();!(p=u.n()).done;){let e=p.value;g.setSeconds(g.getSeconds()+e.timespan_seconds)}}catch(f){u.e(f)}finally{u.f()}return l.a.createElement(T.a,{striped:!0,size:"sm",dark:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{style:a},"#"),l.a.createElement("th",{style:a},"Time"),l.a.createElement("th",{style:a},"Location"))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",{style:t},"Start"),l.a.createElement("td",{style:t},C(h)),l.a.createElement("td",{style:t},c)),l.a.createElement("tr",null,l.a.createElement("td",{style:t},"End"),l.a.createElement("td",{style:t},C(g)),l.a.createElement("td",{style:t},m))))},x=a(43),w=a(44),U=a(57),D=a(59),j=a(60),A=a(58),N=a(118),z=a(122),B=a(121),M=a(120),R=a(119),L=(a(105),a(11)),W=a.n(L);delete W.a.Icon.Default.prototype._getIconUrl,W.a.Icon.Default.mergeOptions({iconRetinaUrl:a(106),iconUrl:a(107),shadowUrl:a(108)});class H extends l.a.Component{constructor(){super(),this.state={selectedFlightPlan:null,internalFlights:{},externalFlights:{},isSettingsModalOpen:!1},this.componentDidMount=()=>{this.interval=setInterval(this.fetchFlightsData,5e3),document.body.addEventListener("click",e=>{this.setState({selectedFlightPlan:null})})},this.componentWillUnmount=()=>{clearInterval(this.interval)},this.getCurrentUtcTimeString=()=>{const e=new Date;return C(e)},this.fetchFlightsData=()=>{fetch("".concat(k(),"/api/Flights?relative_to=").concat(this.getCurrentUtcTimeString())).then(e=>e.json()).then(e=>{const t={},a={};var n,l=Object(d.a)(e);try{for(l.s();!(n=l.n()).done;){let e=n.value;e.is_external?a[e.flight_id]=e:t[e.flight_id]=e}}catch(o){l.e(o)}finally{l.f()}this.setState({internalFlights:t,externalFlights:a})}).catch(e=>{console.error("Error:",e),this.notify("danger",e.message)})},this.setSelectedFlightPlan=(e,t)=>{this.setState({selectedFlightPlan:Object(m.a)(Object(m.a)({},e),{},{flight_id:t})})},this.setInternalFlights=e=>{this.setState({internalFlights:e})},this.notify=(e,t)=>{const a={place:"tc",message:l.a.createElement("div",null,t),type:e,icon:"tim-icons icon-bell-55",autoDismiss:5};try{this.refs.notificationAlert.notificationAlert(a)}catch(n){console.error("Failed to notify: ".concat(t))}},this.interval=null}render(){const e=W.a.icon({iconUrl:a(109),iconSize:[36,36],iconAnchor:[18,18],popupAnchor:[0,0],shadowUrl:null,shadowSize:[0,0],shadowAnchor:[0,0]}),t=W.a.icon({iconUrl:a(110),iconSize:[36,36],iconAnchor:[18,18],popupAnchor:[0,0],shadowUrl:null,shadowSize:[0,0],shadowAnchor:[0,0]}),n=this.state,o=n.internalFlights,c=n.externalFlights,r=n.selectedFlightPlan,s=[];for(var i=0,m=Object.keys(o);i<m.length;i++){let e=m[i];if(r&&e===r.flight_id)continue;const a=[o[e].latitude,o[e].longitude],n=o[e].company_name;s.push(l.a.createElement(N.a,{key:e,icon:t,position:a,onClick:()=>{fetch("".concat(k(),"/api/FlightPlan/").concat(e)).then(e=>e.json()).then(t=>{this.setSelectedFlightPlan(t,e)}).catch(e=>{console.error("Error:",e),this.notify("danger",e.message)})}},l.a.createElement(z.a,null,"Flight #".concat(e),l.a.createElement("br",null),n)))}let h=null,p=[];if(r){const t=r.flight_id;h=o[t]||c[t];const a=[h.latitude,h.longitude],n=h.company_name;s.push(l.a.createElement(N.a,{key:t,icon:e,position:a},l.a.createElement(z.a,null,"Flight #".concat(t),l.a.createElement("br",null),n))),p.push([r.initial_location.latitude,r.initial_location.longitude]);var u,f=Object(d.a)(r.segments);try{for(f.s();!(u=f.n()).done;){let e=u.value;p.push([e.latitude,e.longitude])}}catch(E){f.e(E)}finally{f.f()}}return l.a.createElement(l.a.Fragment,null,l.a.createElement(b,{isOpen:this.state.isSettingsModalOpen,setIsOpen:e=>this.setState({isSettingsModalOpen:e})}),l.a.createElement("i",{className:"fas fa-cog",style:{position:"absolute",fontSize:"2rem",top:"0.1em",right:"0.1em",cursor:"pointer"},onClick:()=>{this.setState({isSettingsModalOpen:!0})}}),l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"react-notification-alert-container"},l.a.createElement(g.a,{ref:"notificationAlert"})),l.a.createElement(x.a,null,l.a.createElement(w.a,{lg:"8"},l.a.createElement(x.a,null,l.a.createElement(U.a,{className:"card-chart"},l.a.createElement(B.a,{center:[31.771959,35.217018],zoom:9,style:{height:"65vh"}},l.a.createElement(M.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s,l.a.createElement(R.a,{positions:p})))),l.a.createElement(x.a,null,r&&l.a.createElement(U.a,{className:"card-chart",style:{marginTop:"-1.5em"}},l.a.createElement(D.a,{style:{padding:"0.5em 0.5em 0"}},l.a.createElement(j.a,{style:{marginBottom:"0.2em"},tag:"h3"},l.a.createElement("span",{style:{fontFamily:"Helvetica"}},"Flight ",l.a.createElement("span",{style:{color:"red"}},r.flight_id)),l.a.createElement("span",{style:{fontFamily:"Helvetica"}}," - ".concat(r.company_name)),l.a.createElement("span",{style:{fontFamily:"Helvetica"}}," - ".concat(r.passengers," Passengers")))),l.a.createElement(A.a,{style:{padding:"1px 4px"}},r&&l.a.createElement(P,{selectedFlightPlan:r}))))),l.a.createElement(w.a,{lg:"4"},l.a.createElement(U.a,{className:"card-chart"},l.a.createElement(A.a,{style:{padding:"1px 10px"}},l.a.createElement(I,{internalFlights:o,externalFlights:c,selectedFlightId:r?r.flight_id:null,setSelectedFlightPlan:this.setSelectedFlightPlan,setInternalFlights:this.setInternalFlights,notify:this.notify})))))))}}var J,q=[{path:"/dashboard",name:"Dashboard",rtlName:"\u0644\u0648\u062d\u0629 \u0627\u0644\u0642\u064a\u0627\u062f\u0629",icon:"tim-icons icon-chart-pie-36",component:H,layout:"/admin"}];class V extends l.a.Component{constructor(e){super(e),this.getRoutes=e=>e.map((e,t)=>"/admin"===e.layout?l.a.createElement(s.b,{path:e.layout+e.path,component:e.component,key:t}):null),this.handleBgClick=e=>{this.setState({backgroundColor:e})},this.state={backgroundColor:"blue",sidebarOpened:-1!==document.documentElement.className.indexOf("nav-open")}}componentDidMount(){if(navigator.platform.indexOf("Win")>-1){document.documentElement.className+=" perfect-scrollbar-on",document.documentElement.classList.remove("perfect-scrollbar-off"),J=new i.a(this.refs.mainPanel,{suppressScrollX:!0});let e=document.querySelectorAll(".table-responsive");for(let t=0;t<e.length;t++)J=new i.a(e[t])}}componentWillUnmount(){navigator.platform.indexOf("Win")>-1&&(J.destroy(),document.documentElement.className+=" perfect-scrollbar-off",document.documentElement.classList.remove("perfect-scrollbar-on"))}componentDidUpdate(e){if("PUSH"===e.history.action){if(navigator.platform.indexOf("Win")>-1){let e=document.querySelectorAll(".table-responsive");for(let t=0;t<e.length;t++)J=new i.a(e[t])}document.documentElement.scrollTop=0,document.scrollingElement.scrollTop=0,this.refs.mainPanel.scrollTop=0}}render(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"wrapper"},l.a.createElement("div",{className:"main-panel",ref:"mainPanel",data:this.state.backgroundColor},l.a.createElement(s.d,null,this.getRoutes(q),l.a.createElement(s.a,{from:"*",to:"/admin/dashboard"})))))}}var X=V;a(113),a(114),a(115);const Y=Object(r.a)();c.a.render(l.a.createElement(s.c,{history:Y},l.a.createElement(s.d,null,l.a.createElement(s.b,{path:"/admin",render:e=>l.a.createElement(X,e)}),l.a.createElement(s.a,{from:"/",to:"/admin/dashboard"}))),document.getElementById("root"))},78:function(e,t,a){e.exports=a(116)}},[[78,1,2]]]);
//# sourceMappingURL=main.a23139ca.chunk.js.map